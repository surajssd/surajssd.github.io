<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Security | Suraj Deshmukh</title>
<meta name="keywords" content="">
<meta name="description" content="Suraj Deshmukh - Personal Blog">
<meta name="author" content="Suraj Deshmukh">
<link rel="canonical" href="https://suraj.io/categories/security/">
<meta name="google-site-verification" content="G-PYJ0C1KVD7">
<link crossorigin="anonymous" href="/assets/css/stylesheet.8fe10233a706bc87f2e08b3cf97b8bd4c0a80f10675a143675d59212121037c0.css" integrity="sha256-j&#43;ECM6cGvIfy4Is8&#43;XuL1MCoDxBnWhQ2ddWSEhIQN8A=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://suraj.io/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://suraj.io/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://suraj.io/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://suraj.io/apple-touch-icon.png">
<link rel="mask-icon" href="https://suraj.io/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" type="application/rss+xml" href="https://suraj.io/categories/security/index.xml">
<link rel="alternate" hreflang="en" href="https://suraj.io/categories/security/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:url" content="https://suraj.io/categories/security/">
  <meta property="og:site_name" content="Suraj Deshmukh">
  <meta property="og:title" content="Security">
  <meta property="og:description" content="Suraj Deshmukh - Personal Blog">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="website">
      <meta property="og:image" content="https://suraj.io/images/papermod-cover.png">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://suraj.io/images/papermod-cover.png">
<meta name="twitter:title" content="Security">
<meta name="twitter:description" content="Suraj Deshmukh - Personal Blog">

</head>

<body class="list" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://suraj.io/" accesskey="h" title="Suraj Deshmukh (Alt + H)">Suraj Deshmukh</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://suraj.io/post" title="Blog">
                    <span>Blog</span>
                </a>
            </li>
            <li>
                <a href="https://suraj.io/about" title="About">
                    <span>About</span>
                </a>
            </li>
            <li>
                <a href="https://suraj.io/archives" title="Archives">
                    <span>Archives</span>
                </a>
            </li>
            <li>
                <a href="https://suraj.io/search" title="Search üîç">
                    <span>Search üîç</span>
                </a>
            </li>
            <li>
                <a href="https://suraj.io/tags" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
            <li>
                <a href="https://suraj.io/categories" title="Categories">
                    <span>Categories</span>
                </a>
            </li>
            <li>
                <a href="https://suraj.io/series" title="Series">
                    <span>Series</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main"> 
<header class="page-header"><div class="breadcrumbs"><a href="https://suraj.io/">Home</a>&nbsp;¬ª&nbsp;<a href="https://suraj.io/categories/">Categories</a></div>
  <h1>
    Security
    <a href="/categories/security/index.xml" title="RSS" aria-label="RSS">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
        stroke-linecap="round" stroke-linejoin="round" height="23">
        <path d="M4 11a9 9 0 0 1 9 9" />
        <path d="M4 4a16 16 0 0 1 16 16" />
        <circle cx="5" cy="19" r="1" />
      </svg>
    </a>
  </h1>
</header>

<article class="post-entry tag-entry"> 
<figure class="entry-cover">
        <img loading="lazy" src="https://suraj.io/post/2024/images/coco-on-azure.png" alt="CoCo on Azure">
</figure>
  <header class="entry-header">
    <h2 class="entry-hint-parent">Open Source Confidential Containers (CoCo) on Azure
    </h2>
  </header>
  <div class="entry-content">
    <p>Introduction In the realm of cloud computing, ensuring data privacy and security is paramount, yet profoundly challenging. One innovative solution to this challenge is Confidential Containers (CoCo)1, designed to provide an extra layer of security for data in use. However, deploying CoCo requires access to specialized hardware, which adds complexity. Beyond just finding the right hardware, the setup involves navigating a maze of technical specifications ‚Äì from BIOS configurations to kernel versions ‚Äì making the process daunting.
...</p>
  </div>
  <footer class="entry-footer"><span title='2024-04-05 09:21:07 +0530 +0530'>April 5, 2024</span>&nbsp;¬∑&nbsp;5 min&nbsp;¬∑&nbsp;Suraj Deshmukh</footer>
  <a class="entry-link" aria-label="post link to Open Source Confidential Containers (CoCo) on Azure" href="https://suraj.io/post/2024/coco-on-azure/"></a>
</article>

<article class="post-entry tag-entry"> 
<figure class="entry-cover">
        <img loading="lazy" src="https://suraj.io/post/2021/09/cks-tips/kubernetes-security-specialist-logo-300x285.png" alt="cert">
</figure>
  <header class="entry-header">
    <h2 class="entry-hint-parent">Certified Kubernetes Security Specialist CKS exam tips
    </h2>
  </header>
  <div class="entry-content">
    <p>I recently cleared the CKS certification exam. So it is incumbent upon me to help you navigate this stress-bound exam. All the tips that are provided are either from accrued knowledge or from personal experience.
Study Material During the study of CKA almost three years ago, I studied everything from the documentation. Back then, the documentation had less content hence it was comprehensible. But now, to go through the entire documentation was not practical. So I did the course by the killer.sh. This course is rich in information, exercises and tries to explain the basics. At the end of each section in the course, the trainer provides resources to read more on the given topic. I would recommend going through each and every resource provided. Don‚Äôt skip these. These resources will help you familiarize yourself with the Kubernetes documentation and support you during the exam.
...</p>
  </div>
  <footer class="entry-footer"><span title='2021-09-04 13:30:07 +0530 +0530'>September 4, 2021</span>&nbsp;¬∑&nbsp;5 min&nbsp;¬∑&nbsp;Suraj Deshmukh</footer>
  <a class="entry-link" aria-label="post link to Certified Kubernetes Security Specialist CKS exam tips" href="https://suraj.io/post/2021/09/cks-tips/"></a>
</article>

<article class="post-entry tag-entry"> 
<figure class="entry-cover">
        <img loading="lazy" src="https://suraj.io/post/2021/06/automatic-cert-gen/obama.jpg" alt="Self Signed Certificates">
</figure>
  <header class="entry-header">
    <h2 class="entry-hint-parent">How to &#39;automatically&#39; generate a self-signed TLS certificate for Kubernetes Admission Webhook Servers?
    </h2>
  </header>
  <div class="entry-content">
    <p>The previous blog talked about generating self-signed certificates using a binary. It was a manual, cumbersome process where you had to generate the certificates using a tool, embed them into a Kubernetes Secret via Helm chart, and then use it. There is a better way of doing it! Which is what this blog will discuss.
We will use a Helm chart, which has a couple of Kubernetes Jobs that generates the self-signed certificate, embed them in a Kubernetes Secret and finally update the ValidatingWebhookConfiguration or MutatingWebhookConfiguration of your choice. And that‚Äôs it. Life is simpler!
...</p>
  </div>
  <footer class="entry-footer"><span title='2021-06-25 09:00:00 +0530 +0530'>June 25, 2021</span>&nbsp;¬∑&nbsp;4 min&nbsp;¬∑&nbsp;Suraj Deshmukh</footer>
  <a class="entry-link" aria-label="post link to How to &#39;automatically&#39; generate a self-signed TLS certificate for Kubernetes Admission Webhook Servers?" href="https://suraj.io/post/2021/06/automatic-cert-gen/"></a>
</article>

<article class="post-entry tag-entry"> 
<figure class="entry-cover">
        <img loading="lazy" src="https://suraj.io/post/2021/05/self-sign-k8s-cert/cert.png" alt="cert">
</figure>
  <header class="entry-header">
    <h2 class="entry-hint-parent">How to generate a self-signed TLS certificate for Kubernetes Admission Webhook Servers?
    </h2>
  </header>
  <div class="entry-content">
    <p> UPDATE: There is a way to generate these certificates automatically. To find out how, read this post.
If you are writing a webhook server for Kubernetes Admission Controllers like ValidatingAdmissionWebhooks or MutatingAdmissionWebhooks, you must expose it over HTTPS. To run these servers on HTTPS, you need TLS certificates. There are solutions available which you can use to solve this problem, first and foremost that comes to my mind is cert-manager. It is a great project and automates this problem. But it is an added dependency that you might have to keep running in your cluster.
...</p>
  </div>
  <footer class="entry-footer"><span title='2021-05-21 15:33:07 +0530 +0530'>May 21, 2021</span>&nbsp;¬∑&nbsp;2 min&nbsp;¬∑&nbsp;Suraj Deshmukh</footer>
  <a class="entry-link" aria-label="post link to How to generate a self-signed TLS certificate for Kubernetes Admission Webhook Servers?" href="https://suraj.io/post/2021/05/self-sign-k8s-cert/"></a>
</article>

<article class="post-entry tag-entry"> 
<figure class="entry-cover">
        <img loading="lazy" src="https://suraj.io/post/2021/05/access-k8s-secrets-mitigation/config.png" alt="Config">
</figure>
  <header class="entry-header">
    <h2 class="entry-hint-parent">Mitigation of: Access Any Kubernetes Secret
    </h2>
  </header>
  <div class="entry-content">
    <p>In the previous blog, we discussed how any user without RBAC access to a Kubernetes secret can use a trick to access that secret. To mitigate that problem, we will use a validating admission webhook. But before looking at what sorcery this validating admission webhook server is, let us understand how Kubernetes handles the API requests.
What are admission controllers? All requests going to the Kubernetes API server go through the following four steps:
...</p>
  </div>
  <footer class="entry-footer"><span title='2021-05-20 08:47:07 +0530 +0530'>May 20, 2021</span>&nbsp;¬∑&nbsp;4 min&nbsp;¬∑&nbsp;Suraj Deshmukh</footer>
  <a class="entry-link" aria-label="post link to Mitigation of: Access Any Kubernetes Secret" href="https://suraj.io/post/2021/05/access-k8s-secrets-mitigation/"></a>
</article>

<article class="post-entry tag-entry"> 
<figure class="entry-cover">
        <img loading="lazy" src="https://suraj.io/post/2021/05/access-k8s-secrets/forbidden.jpg" alt="Forbidden">
</figure>
  <header class="entry-header">
    <h2 class="entry-hint-parent">Access Any Kubernetes Secret
    </h2>
  </header>
  <div class="entry-content">
    <p>You can gain access to any secret that you want in Kubernetes even if you don‚Äôt have RBAC permissions to get, list or view that secret. All you need is permission that allows you to do anything on pods and an ability to guess the names of secrets. With these two ingredients, here is how you can access any secret out there.
Nasty User Here is a user called nastyuser who can only do stuff on pod objects. Everything else is forbidden. The user cannot list secrets, namespaces or deployments:
...</p>
  </div>
  <footer class="entry-footer"><span title='2021-05-08 12:17:07 +0530 +0530'>May 8, 2021</span>&nbsp;¬∑&nbsp;5 min&nbsp;¬∑&nbsp;Suraj Deshmukh</footer>
  <a class="entry-link" aria-label="post link to Access Any Kubernetes Secret" href="https://suraj.io/post/2021/05/access-k8s-secrets/"></a>
</article>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">Watch Container Traffic Without Exec
    </h2>
  </header>
  <div class="entry-content">
    <p>Introduction For the reasons of security, many container deployments nowadays run their workloads in a scratch based image. This form of implementation helps reduce the attack surface since there is no shell to gain access to, especially if someone were to break out of the application.
But for the developers or operators of such applications, it is hard to debug. Since they lack essential tools or even bash for that matter, but the application‚Äôs debugging ability should not dictate its production deployment and compromise its security posture.
...</p>
  </div>
  <footer class="entry-footer"><span title='2020-06-06 20:30:07 +0530 +0530'>June 6, 2020</span>&nbsp;¬∑&nbsp;4 min&nbsp;¬∑&nbsp;Suraj Deshmukh</footer>
  <a class="entry-link" aria-label="post link to Watch Container Traffic Without Exec" href="https://suraj.io/post/snoop-on-pod-traffic/"></a>
</article>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">Enabling Seccomp on your Prometheus Operator and related Pods
    </h2>
  </header>
  <div class="entry-content">
    <p>Seccomp helps us limit the system calls the process inside container can make. And PodSecurityPolicy is the way to enable it on pods in Kubernetes.
Prometheus Operator Prometheus Operator makes it really easy to monitor your Kubernetes cluster. To deploy this behemoth, helm chart is the easiest way to do it.
Almost all the pods that run as a part of Prometheus Operator viz. Prometheus Operator, Prometheus, Alertmanager, Grafana, Kube State Metrics don‚Äôt need to run with elevated privileges except Node Exporter. In your Kubernetes cluster if you are using PodSecurityPolicy to make sure that your cluster is secure, then you would want your Prometheus Operator pods to run securely as well. And the good news is, Prometheus Operator chart ships PodSecurityPolicy for each sub-component. We will look at how to enable seccomp for all the sub-components.
...</p>
  </div>
  <footer class="entry-footer"><span title='2020-04-14 11:57:07 +0530 +0530'>April 14, 2020</span>&nbsp;¬∑&nbsp;3 min&nbsp;¬∑&nbsp;Suraj Deshmukh</footer>
  <a class="entry-link" aria-label="post link to Enabling Seccomp on your Prometheus Operator and related Pods" href="https://suraj.io/post/seccomp-in-kube-state-metrics/"></a>
</article>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">Capabilities on executables
    </h2>
  </header>
  <div class="entry-content">
    <p>File capabilities allow users to execute programs with higher privileges. Best example is network utility ping.
A ping binary has capabilities CAP_NET_ADMIN and CAP_NET_RAW. A normal user doesn‚Äôt have CAP_NET_ADMIN privilege, since the executable file ping has that capability you can run it.
$ getcap `which ping` /usr/bin/ping = cap_net_admin,cap_net_raw&#43;p Which normally works as follows:
$ ping -c 1 1.1.1.1 PING 1.1.1.1 (1.1.1.1) 56(84) bytes of data. 64 bytes from 1.1.1.1: icmp_seq=1 ttl=55 time=36.9 ms --- 1.1.1.1 ping statistics --- 1 packets transmitted, 1 received, 0% packet loss, time 0ms rtt min/avg/max/mdev = 36.885/36.885/36.885/0.000 ms If you copy file as a normal user the binary loses its privilege and the command ceases to work:
...</p>
  </div>
  <footer class="entry-footer"><span title='2019-06-25 15:15:07 +0530 +0530'>June 25, 2019</span>&nbsp;¬∑&nbsp;1 min&nbsp;¬∑&nbsp;Suraj Deshmukh</footer>
  <a class="entry-link" aria-label="post link to Capabilities on executables" href="https://suraj.io/post/linux-cap-note/"></a>
</article>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">Root user inside container is root on the host
    </h2>
  </header>
  <div class="entry-content">
    <p>Here are simple steps that you can follow to prove that the root user inside container is also root on the host. And how to mitigate this.
Root in container, root on host I have a host with docker daemon running on it. I start a normal container on it with sleep process as PID1. See in the following output that the container clever_lalande started with sleep process.
$ docker run -d --rm alpine sleep 9999 6c541cf8f7b315783d2315eebc2f7dddd1f7b26f427e182f8597b10f2746ab0b $ docker ps CONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES 6c541cf8f7b3 alpine &#34;sleep 9999&#34; 12 seconds ago Up 11 seconds clever_lalande Now let‚Äôs find out the process sleep on the host. Here in the following output you can see that the process sleep is running as user root.
...</p>
  </div>
  <footer class="entry-footer"><span title='2019-06-25 11:57:07 +0530 +0530'>June 25, 2019</span>&nbsp;¬∑&nbsp;4 min&nbsp;¬∑&nbsp;Suraj Deshmukh</footer>
  <a class="entry-link" aria-label="post link to Root user inside container is root on the host" href="https://suraj.io/post/root-in-container-root-on-host/"></a>
</article>
<footer class="page-footer">
  <nav class="pagination">
    <a class="next" href="https://suraj.io/categories/security/page/2/">Next&nbsp;2/2&nbsp;¬ª
    </a>
  </nav>
</footer>
    </main>
    
<footer class="footer">
        <span>&copy; 2025 <a href="https://suraj.io/">Suraj Deshmukh</a></span> ¬∑ 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
