<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>How to import &#39;any&#39; Kubernetes package into your project? | Suraj Deshmukh</title>
<meta name="keywords" content="kubernetes, golang">
<meta name="description" content="The client libraries that Kubernetes ships are meant to be imported, and you definitely don&rsquo;t need this post explaining how to import them in your Golang based project. A simple go get ... should do the trick. But, what about the packages that are not meant to be imported? Or the ones that cannot be imported because of &ldquo;technical reasons&rdquo; ? Could you simply add them to your import statements in the .go file, and the go binary will do the right thing when you build the code? Well, let&rsquo;s find that out!">
<meta name="author" content="Suraj Deshmukh">
<link rel="canonical" href="https://suraj.io/post/2021/05/k8s-import/">
<meta name="google-site-verification" content="G-PYJ0C1KVD7">
<link crossorigin="anonymous" href="/assets/css/stylesheet.8fe10233a706bc87f2e08b3cf97b8bd4c0a80f10675a143675d59212121037c0.css" integrity="sha256-j&#43;ECM6cGvIfy4Is8&#43;XuL1MCoDxBnWhQ2ddWSEhIQN8A=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://suraj.io/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://suraj.io/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://suraj.io/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://suraj.io/apple-touch-icon.png">
<link rel="mask-icon" href="https://suraj.io/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://suraj.io/post/2021/05/k8s-import/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:url" content="https://suraj.io/post/2021/05/k8s-import/">
  <meta property="og:site_name" content="Suraj Deshmukh">
  <meta property="og:title" content="How to import &#39;any&#39; Kubernetes package into your project?">
  <meta property="og:description" content="The client libraries that Kubernetes ships are meant to be imported, and you definitely don‚Äôt need this post explaining how to import them in your Golang based project. A simple go get ... should do the trick. But, what about the packages that are not meant to be imported? Or the ones that cannot be imported because of ‚Äútechnical reasons‚Äù ? Could you simply add them to your import statements in the .go file, and the go binary will do the right thing when you build the code? Well, let‚Äôs find that out!">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="post">
    <meta property="article:published_time" content="2021-05-30T09:40:00+05:30">
    <meta property="article:modified_time" content="2021-05-30T09:40:00+05:30">
    <meta property="article:tag" content="Kubernetes">
    <meta property="article:tag" content="Golang">
    <meta property="og:image" content="https://suraj.io/post/2021/05/k8s-import/gok8s.jpg">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://suraj.io/post/2021/05/k8s-import/gok8s.jpg">
<meta name="twitter:title" content="How to import &#39;any&#39; Kubernetes package into your project?">
<meta name="twitter:description" content="The client libraries that Kubernetes ships are meant to be imported, and you definitely don&rsquo;t need this post explaining how to import them in your Golang based project. A simple go get ... should do the trick. But, what about the packages that are not meant to be imported? Or the ones that cannot be imported because of &ldquo;technical reasons&rdquo; ? Could you simply add them to your import statements in the .go file, and the go binary will do the right thing when you build the code? Well, let&rsquo;s find that out!">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://suraj.io/post/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "How to import 'any' Kubernetes package into your project?",
      "item": "https://suraj.io/post/2021/05/k8s-import/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "How to import 'any' Kubernetes package into your project?",
  "name": "How to import \u0027any\u0027 Kubernetes package into your project?",
  "description": "The client libraries that Kubernetes ships are meant to be imported, and you definitely don\u0026rsquo;t need this post explaining how to import them in your Golang based project. A simple go get ... should do the trick. But, what about the packages that are not meant to be imported? Or the ones that cannot be imported because of \u0026ldquo;technical reasons\u0026rdquo; ? Could you simply add them to your import statements in the .go file, and the go binary will do the right thing when you build the code? Well, let\u0026rsquo;s find that out!\n",
  "keywords": [
    "kubernetes", "golang"
  ],
  "articleBody": "The client libraries that Kubernetes ships are meant to be imported, and you definitely don‚Äôt need this post explaining how to import them in your Golang based project. A simple go get ... should do the trick. But, what about the packages that are not meant to be imported? Or the ones that cannot be imported because of ‚Äútechnical reasons‚Äù ? Could you simply add them to your import statements in the .go file, and the go binary will do the right thing when you build the code? Well, let‚Äôs find that out!\nUsecase I have a project, and in it, the imported packages look like this:\nimport ( \"crypto/x509\" \"fmt\" \"io/ioutil\" \"log\" \"path/filepath\" \"github.com/spf13/cobra\" \"k8s.io/client-go/util/cert\" \"k8s.io/client-go/util/keyutil\" \"k8s.io/kubernetes/test/utils\" ) source\nSo it consists of a couple of inbuilt packages, and then the CLI library Cobra, a couple of client-go packages. The only out of the ordinary thing is the k8s.io/kubernetes/test/utils package.\nImporting Let us tidy up the dependencies before building the code:\n$ go get github.com/spf13/cobra \\ \u003e k8s.io/client-go/util/cert \\ \u003e k8s.io/client-go/util/keyutil \\ \u003e k8s.io/kubernetes/test/utils go: downloading k8s.io/client-go v1.5.2 go: downloading github.com/spf13/cobra v1.1.3 go: downloading k8s.io/kubernetes v1.21.1 go: downloading k8s.io/client-go v0.21.1 go get: k8s.io/kubernetes@v1.15.0-alpha.0 updating to k8s.io/kubernetes@v1.21.1 requires k8s.io/api@v0.0.0: reading k8s.io/api/go.mod at revision v0.0.0: unknown revision v0.0.0 Now, this is a weird error:\nk8s.io/api@v0.0.0: reading k8s.io/api/go.mod at revision v0.0.0: unknown revision v0.0.0 tl;dr Give me the solution NOTE: Please read the ‚ÄúCaveats‚Äù section before you venture into using this solution.\nSave the following bash script in download-deps.sh:\n#!/bin/bash VERSION=${1#\"v\"} if [ -z \"$VERSION\" ]; then echo \"Please specify the Kubernetes version: e.g.\" echo \"./download-deps.sh v1.21.0\" exit 1 fi set -euo pipefail # Find out all the replaced imports, make a list of them. MODS=($( curl -sS \"https://raw.githubusercontent.com/kubernetes/kubernetes/v${VERSION}/go.mod\" | sed -n 's|.*k8s.io/\\(.*\\) =\u003e ./staging/src/k8s.io/.*|k8s.io/\\1|p' )) # Now add those similar replace statements in the local go.mod file, but first find the version that # the Kubernetes is using for them. for MOD in \"${MODS[@]}\"; do V=$( go mod download -json \"${MOD}@kubernetes-${VERSION}\" | sed -n 's|.*\"Version\": \"\\(.*\\)\".*|\\1|p' ) go mod edit \"-replace=${MOD}=${MOD}@${V}\" done go get \"k8s.io/kubernetes@v${VERSION}\" go mod download Make the script usable:\nchmod u+x download-deps.sh Use the following script. It will update the go.mod file with the required dependencies:\n$ ./download-deps.sh v1.21.0 go: downloading k8s.io/kubernetes v1.21.0 go get: added k8s.io/kubernetes v1.21.0 Now you can build your code! Keep reading further to understand why this happens.\nKudos üëè to Andy Bursavich for writing the aforementioned script. I took the script from this comment and made minor modifications.\nReasoning The error k8s.io/api@v0.0.0: reading k8s.io/api/go.mod at revision v0.0.0: unknown revision v0.0.0 is caused because, in Kubernetes‚Äôs go.mod, you will find the following snippet:\nrequire ( ... k8s.io/api v0.0.0 k8s.io/apiextensions-apiserver v0.0.0 k8s.io/apimachinery v0.0.0 k8s.io/apiserver v0.0.0 ... ) replace ( ... k8s.io/api =\u003e ./staging/src/k8s.io/api k8s.io/apiextensions-apiserver =\u003e ./staging/src/k8s.io/apiextensions-apiserver k8s.io/apimachinery =\u003e ./staging/src/k8s.io/apimachinery k8s.io/apiserver =\u003e ./staging/src/k8s.io/apiserver ... ) In the Kubernetes repository, the packages listed under require directive are tagged with a pseudo-version v0.0.0 but then are replaced with a local code in the staging directory. Now replace directive works fine when building Kubernetes itself but won‚Äôt work when someone is importing it. The Golang documentation says the following about replace directive:\nreplace directives only apply in the main module‚Äôs go.mod file and are ignored in other modules.\nsource\nGenerally, the pseudo-version has a format v0.0.0-Time-commit_id, but in this case, it practically is a dead end. Why is Kubernetes doing such a thing in their project? Why not tag with an actual pseudo-version format? Well, because the code is available locally. And the directories in the staging folder are published as standalone projects for folks to use later on.\nSo the net effect is that I am trying to import code using go get, but it is tagged with a pseudo-version v0.0.0 and hence go get fails. The solution to this problem is to find the correct versions of those dependencies yourself and add them to your repo‚Äôs go.mod under replace directive.\nThis is precisely what the script is doing.\nFinal Go Mod So in our project, the go.mod looks like this from the successful imports before running the script:\nmodule foobar go 1.16 require ( github.com/spf13/cobra v1.1.3 // indirect k8s.io/client-go v0.21.1 // indirect ) After running the script, this is how it looks like:\nmodule foobar go 1.16 require ( github.com/spf13/cobra v1.1.3 // indirect k8s.io/client-go v0.21.1 // indirect k8s.io/kubernetes v1.21.0 // indirect ) replace k8s.io/api =\u003e k8s.io/api v0.21.0 replace k8s.io/apiextensions-apiserver =\u003e k8s.io/apiextensions-apiserver v0.21.0 replace k8s.io/apimachinery =\u003e k8s.io/apimachinery v0.21.1-rc.0 replace k8s.io/apiserver =\u003e k8s.io/apiserver v0.21.0 ... Caveats Kubernetes upstream cautions against using the packages as we have done in this blog (Thanks, Dims, for bringing this to my notice):\nTo use Kubernetes code as a library in other applications, see the list of published components. Use of the k8s.io/kubernetes module or k8s.io/kubernetes/... packages as libraries is not supported.\nsource\nIf you are importing a package that is not supported as a library by the upstream community, you might be up for a catch-up going forward. The unsupported, non-library packages are subject to API definition changes without any public warning. And if your production code relies on such a package, it might impact you. At that point, you have no right to go and accuse upstream of not being public about the changes.\nThat being said, if there are any libraries you identify that are widely used and should be published, bring them to the notice of the upstream community. They will surely help in publishing them. This helps the broader community by consuming the libraries from a widely published place and saving anyone and everyone from catching up. But unless they are not published as libraries consuming anything else is a call for a lot of code churn.\n",
  "wordCount" : "948",
  "inLanguage": "en",
  "image":"https://suraj.io/post/2021/05/k8s-import/gok8s.jpg","datePublished": "2021-05-30T09:40:00+05:30",
  "dateModified": "2021-05-30T09:40:00+05:30",
  "author":{
    "@type": "Person",
    "name": "Suraj Deshmukh"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://suraj.io/post/2021/05/k8s-import/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Suraj Deshmukh",
    "logo": {
      "@type": "ImageObject",
      "url": "https://suraj.io/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://suraj.io/" accesskey="h" title="Suraj Deshmukh (Alt + H)">Suraj Deshmukh</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://suraj.io/post" title="Blog">
                    <span>Blog</span>
                </a>
            </li>
            <li>
                <a href="https://suraj.io/about" title="About">
                    <span>About</span>
                </a>
            </li>
            <li>
                <a href="https://suraj.io/archives" title="Archives">
                    <span>Archives</span>
                </a>
            </li>
            <li>
                <a href="https://suraj.io/search" title="Search üîç">
                    <span>Search üîç</span>
                </a>
            </li>
            <li>
                <a href="https://suraj.io/tags" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
            <li>
                <a href="https://suraj.io/categories" title="Categories">
                    <span>Categories</span>
                </a>
            </li>
            <li>
                <a href="https://suraj.io/series" title="Series">
                    <span>Series</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://suraj.io/">Home</a>&nbsp;¬ª&nbsp;<a href="https://suraj.io/post/">Posts</a></div>
    <h1 class="post-title entry-hint-parent">
      How to import &#39;any&#39; Kubernetes package into your project?
    </h1>
    <div class="post-meta"><span title='2021-05-30 09:40:00 +0530 +0530'>May 30, 2021</span>&nbsp;¬∑&nbsp;5 min&nbsp;¬∑&nbsp;Suraj Deshmukh&nbsp;|&nbsp;<a href="https://github.com/surajssd/blog_contents/blob/master/content/post/2021/05/k8s-import.md" rel="noopener noreferrer edit" target="_blank">Suggest Changes</a>

</div>
  </header> 
<figure class="entry-cover">
        <img loading="eager" src="https://suraj.io/post/2021/05/k8s-import/gok8s.jpg" alt="Golang and Kubernetes">
        
</figure><div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#usecase" aria-label="Usecase">Usecase</a></li>
                <li>
                    <a href="#importing" aria-label="Importing">Importing</a></li>
                <li>
                    <a href="#tldr-give-me-the-solution" aria-label="tl;dr Give me the solution">tl;dr Give me the solution</a></li>
                <li>
                    <a href="#reasoning" aria-label="Reasoning">Reasoning</a></li>
                <li>
                    <a href="#final-go-mod" aria-label="Final Go Mod">Final Go Mod</a></li>
                <li>
                    <a href="#caveats" aria-label="Caveats">Caveats</a>
                </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><p>The client libraries that Kubernetes ships are meant to be imported, and you definitely don&rsquo;t need this post explaining how to import them in your Golang based project. A simple <code>go get ...</code> should do the trick. But, what about the packages that are not meant to be imported? Or the ones that cannot be imported because of <em>&ldquo;technical reasons&rdquo;</em> ? Could you simply add them to your import statements in the <code>.go</code> file, and the <code>go</code> binary will do the right thing when you build the code? Well, let&rsquo;s find that out!</p>
<h2 id="usecase">Usecase<a hidden class="anchor" aria-hidden="true" href="#usecase">#</a></h2>
<p>I have a project, and in it, the imported packages look like this:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl"><span class="kn">import</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl"> <span class="s">&#34;crypto/x509&#34;</span>
</span></span><span class="line"><span class="cl"> <span class="s">&#34;fmt&#34;</span>
</span></span><span class="line"><span class="cl"> <span class="s">&#34;io/ioutil&#34;</span>
</span></span><span class="line"><span class="cl"> <span class="s">&#34;log&#34;</span>
</span></span><span class="line"><span class="cl"> <span class="s">&#34;path/filepath&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> <span class="s">&#34;github.com/spf13/cobra&#34;</span>
</span></span><span class="line"><span class="cl"> <span class="s">&#34;k8s.io/client-go/util/cert&#34;</span>
</span></span><span class="line"><span class="cl"> <span class="s">&#34;k8s.io/client-go/util/keyutil&#34;</span>
</span></span><span class="line"><span class="cl"> <span class="s">&#34;k8s.io/kubernetes/test/utils&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span></code></pre></div><p><a href="https://github.com/surajssd/self-signed-cert/blob/61a5c44ca2f4d6d951b361e1f271bd13ce355f9d/main.go#L3-L14">source</a></p>
<p>So it consists of a couple of inbuilt packages, and then the CLI library <a href="https://github.com/spf13/cobra">Cobra</a>, a couple of <a href="https://github.com/kubernetes/client-go">client-go</a> packages. The only out of the ordinary thing is the <code>k8s.io/kubernetes/test/utils</code> package.</p>
<h2 id="importing">Importing<a hidden class="anchor" aria-hidden="true" href="#importing">#</a></h2>
<p>Let us tidy up the dependencies before building the code:</p>
<pre tabindex="0"><code>$ go get github.com/spf13/cobra \
&gt;        k8s.io/client-go/util/cert \
&gt;        k8s.io/client-go/util/keyutil \
&gt;        k8s.io/kubernetes/test/utils
go: downloading k8s.io/client-go v1.5.2
go: downloading github.com/spf13/cobra v1.1.3
go: downloading k8s.io/kubernetes v1.21.1
go: downloading k8s.io/client-go v0.21.1
go get: k8s.io/kubernetes@v1.15.0-alpha.0 updating to
        k8s.io/kubernetes@v1.21.1 requires
        k8s.io/api@v0.0.0: reading k8s.io/api/go.mod at revision v0.0.0: unknown revision v0.0.0
</code></pre><p>Now, this is a weird error:</p>
<pre tabindex="0"><code>k8s.io/api@v0.0.0: reading k8s.io/api/go.mod at revision v0.0.0: unknown revision v0.0.0
</code></pre><h2 id="tldr-give-me-the-solution">tl;dr Give me the solution<a hidden class="anchor" aria-hidden="true" href="#tldr-give-me-the-solution">#</a></h2>
<p><strong>NOTE</strong>: Please read the &ldquo;Caveats&rdquo; section before you venture into using this solution.</p>
<p>Save the following bash script in <code>download-deps.sh</code>:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="cp">#!/bin/bash
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="nv">VERSION</span><span class="o">=</span><span class="si">${</span><span class="nv">1</span><span class="p">#</span><span class="s2">&#34;v&#34;</span><span class="si">}</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="o">[</span> -z <span class="s2">&#34;</span><span class="nv">$VERSION</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
</span></span><span class="line"><span class="cl">  <span class="nb">echo</span> <span class="s2">&#34;Please specify the Kubernetes version: e.g.&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="nb">echo</span> <span class="s2">&#34;./download-deps.sh v1.21.0&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="nb">exit</span> <span class="m">1</span>
</span></span><span class="line"><span class="cl"><span class="k">fi</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">set</span> -euo pipefail
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Find out all the replaced imports, make a list of them.</span>
</span></span><span class="line"><span class="cl"><span class="nv">MODS</span><span class="o">=(</span><span class="k">$(</span>
</span></span><span class="line"><span class="cl">  curl -sS <span class="s2">&#34;https://raw.githubusercontent.com/kubernetes/kubernetes/v</span><span class="si">${</span><span class="nv">VERSION</span><span class="si">}</span><span class="s2">/go.mod&#34;</span> <span class="p">|</span>
</span></span><span class="line"><span class="cl">    sed -n <span class="s1">&#39;s|.*k8s.io/\(.*\) =&gt; ./staging/src/k8s.io/.*|k8s.io/\1|p&#39;</span>
</span></span><span class="line"><span class="cl"><span class="k">)</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Now add those similar replace statements in the local go.mod file, but first find the version that</span>
</span></span><span class="line"><span class="cl"><span class="c1"># the Kubernetes is using for them.</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> MOD in <span class="s2">&#34;</span><span class="si">${</span><span class="nv">MODS</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">;</span> <span class="k">do</span>
</span></span><span class="line"><span class="cl">  <span class="nv">V</span><span class="o">=</span><span class="k">$(</span>
</span></span><span class="line"><span class="cl">    go mod download -json <span class="s2">&#34;</span><span class="si">${</span><span class="nv">MOD</span><span class="si">}</span><span class="s2">@kubernetes-</span><span class="si">${</span><span class="nv">VERSION</span><span class="si">}</span><span class="s2">&#34;</span> <span class="p">|</span>
</span></span><span class="line"><span class="cl">      sed -n <span class="s1">&#39;s|.*&#34;Version&#34;: &#34;\(.*\)&#34;.*|\1|p&#39;</span>
</span></span><span class="line"><span class="cl">  <span class="k">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  go mod edit <span class="s2">&#34;-replace=</span><span class="si">${</span><span class="nv">MOD</span><span class="si">}</span><span class="s2">=</span><span class="si">${</span><span class="nv">MOD</span><span class="si">}</span><span class="s2">@</span><span class="si">${</span><span class="nv">V</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="k">done</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">go get <span class="s2">&#34;k8s.io/kubernetes@v</span><span class="si">${</span><span class="nv">VERSION</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">go mod download
</span></span></code></pre></div><p>Make the script usable:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">chmod u+x download-deps.sh
</span></span></code></pre></div><p>Use the following script. It will update the <code>go.mod</code> file with the required dependencies:</p>
<pre tabindex="0"><code class="language-consle" data-lang="consle">$ ./download-deps.sh v1.21.0
go: downloading k8s.io/kubernetes v1.21.0
go get: added k8s.io/kubernetes v1.21.0
</code></pre><p>Now you can build your code! Keep reading further to understand why this happens.</p>
<blockquote>
<p>Kudos üëè to <a href="https://github.com/abursavich">Andy Bursavich</a> for writing the aforementioned script. I took the script from <a href="https://github.com/kubernetes/kubernetes/issues/79384#issuecomment-521493597">this comment</a> and made minor modifications.</p></blockquote>
<h2 id="reasoning">Reasoning<a hidden class="anchor" aria-hidden="true" href="#reasoning">#</a></h2>
<p>The error <code>k8s.io/api@v0.0.0: reading k8s.io/api/go.mod at revision v0.0.0: unknown revision v0.0.0</code> is caused because, in Kubernetes&rsquo;s <a href="https://github.com/kubernetes/kubernetes/blob/e6136c0303028d68cac67290d94a60cec167ccdf/go.mod#L109-L120"><code>go.mod</code></a>, you will find the following snippet:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="l">require (</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nn">...</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span><span class="l">k8s.io/api v0.0.0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span><span class="l">k8s.io/apiextensions-apiserver v0.0.0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span><span class="l">k8s.io/apimachinery v0.0.0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span><span class="l">k8s.io/apiserver v0.0.0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nn">...</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="l">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="l">replace (</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nn">...</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span><span class="l">k8s.io/api =&gt; ./staging/src/k8s.io/api</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span><span class="l">k8s.io/apiextensions-apiserver =&gt; ./staging/src/k8s.io/apiextensions-apiserver</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span><span class="l">k8s.io/apimachinery =&gt; ./staging/src/k8s.io/apimachinery</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span><span class="l">k8s.io/apiserver =&gt; ./staging/src/k8s.io/apiserver</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nn">...</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="l">)</span><span class="w">
</span></span></span></code></pre></div><p>In the Kubernetes repository, the packages listed under <code>require</code> directive are tagged with a pseudo-version <code>v0.0.0</code> but then are replaced with a local code in the <a href="https://github.com/kubernetes/kubernetes/tree/e8760b95bb0a0dfb5c184fd4e5ab95da3650a040/staging"><code>staging</code></a> directory. Now <code>replace</code> directive works fine when building Kubernetes itself but won&rsquo;t work when someone is importing it. The Golang documentation says the following about <code>replace</code> directive:</p>
<blockquote>
<p><code>replace</code> directives only apply in the main module&rsquo;s go.mod file and are ignored in other modules.</p></blockquote>
<p><a href="https://golang.org/ref/mod#go-mod-file-replace">source</a></p>
<p>Generally, the pseudo-version has a format <code>v0.0.0-Time-commit_id</code>, but in this case, it practically is a dead end. Why is Kubernetes doing such a thing in their project? Why not tag with an actual pseudo-version format? Well, because the code is available locally. And the directories in the <code>staging</code> folder are published as standalone projects for folks to use later on.</p>
<p>So the net effect is that I am trying to import code using <code>go get</code>, but it is tagged with a pseudo-version <code>v0.0.0</code> and hence <code>go get</code> fails. The solution to this problem is to find the correct versions of those dependencies yourself and add them to your repo&rsquo;s <code>go.mod</code> under <code>replace</code> directive.</p>
<p>This is precisely what the script is doing.</p>
<h2 id="final-go-mod">Final Go Mod<a hidden class="anchor" aria-hidden="true" href="#final-go-mod">#</a></h2>
<p>So in our project, the <code>go.mod</code> looks like this from the successful imports before running the script:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="l">module foobar</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="l">go 1.16</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="l">require (</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="l">github.com/spf13/cobra v1.1.3 // indirect</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="l">k8s.io/client-go v0.21.1 // indirect</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="l">)</span><span class="w">
</span></span></span></code></pre></div><p>After running the script, this is how it looks like:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="l">module foobar</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="l">go 1.16</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="l">require (</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="l">github.com/spf13/cobra v1.1.3 // indirect</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="l">k8s.io/client-go v0.21.1 // indirect</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="l">k8s.io/kubernetes v1.21.0 // indirect</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="l">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="l">replace k8s.io/api =&gt; k8s.io/api v0.21.0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="l">replace k8s.io/apiextensions-apiserver =&gt; k8s.io/apiextensions-apiserver v0.21.0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="l">replace k8s.io/apimachinery =&gt; k8s.io/apimachinery v0.21.1-rc.0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="l">replace k8s.io/apiserver =&gt; k8s.io/apiserver v0.21.0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nn">...</span><span class="w">
</span></span></span></code></pre></div><h2 id="caveats">Caveats<a hidden class="anchor" aria-hidden="true" href="#caveats">#</a></h2>
<p>Kubernetes upstream cautions against using the packages as we have done in this blog (Thanks, <a href="https://twitter.com/dims/status/1398972850883682304">Dims</a>, for bringing this to my notice):</p>
<blockquote>
<p>To use Kubernetes code as a library in other applications, see the <a href="https://github.com/kubernetes/kubernetes/blob/master/staging/README.md">list of published components</a>. Use of the <code>k8s.io/kubernetes</code> module or <code>k8s.io/kubernetes/...</code> packages as libraries is not supported.</p></blockquote>
<p><a href="https://github.com/kubernetes/kubernetes#to-start-using-k8s">source</a></p>
<p>If you are importing a package that is not supported as a library by the upstream community, you might be up for a catch-up going forward. The unsupported, non-library packages are subject to API definition changes without any public warning. And if your production code relies on such a package, it might impact you. At that point, you have no right to go and accuse upstream of not being public about the changes.</p>
<p>That being said, if there are any libraries you identify that are widely used and should be published, bring them to the notice of the upstream community. They will surely help in publishing them. This helps the broader community by consuming the libraries from a widely published place and saving anyone and everyone from catching up. But unless they are not published as libraries consuming anything else is a call for a lot of code churn.</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://suraj.io/tags/kubernetes/">Kubernetes</a></li>
      <li><a href="https://suraj.io/tags/golang/">Golang</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="https://suraj.io/post/2021/06/systemd-service/">
    <span class="title">¬´ Prev</span>
    <br>
    <span>How to create a Systemd daemon quickly?</span>
  </a>
  <a class="next" href="https://suraj.io/post/2021/05/self-sign-k8s-cert/">
    <span class="title">Next ¬ª</span>
    <br>
    <span>How to generate a self-signed TLS certificate for Kubernetes Admission Webhook Servers?</span>
  </a>
</nav>


<ul class="share-buttons">
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share How to import &#39;any&#39; Kubernetes package into your project? on x"
            href="https://x.com/intent/tweet/?text=How%20to%20import%20%27any%27%20Kubernetes%20package%20into%20your%20project%3f&amp;url=https%3a%2f%2fsuraj.io%2fpost%2f2021%2f05%2fk8s-import%2f&amp;hashtags=kubernetes%2cgolang">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M512 62.554 L 512 449.446 C 512 483.97 483.97 512 449.446 512 L 62.554 512 C 28.03 512 0 483.97 0 449.446 L 0 62.554 C 0 28.03 28.029 0 62.554 0 L 449.446 0 C 483.971 0 512 28.03 512 62.554 Z M 269.951 190.75 L 182.567 75.216 L 56 75.216 L 207.216 272.95 L 63.9 436.783 L 125.266 436.783 L 235.9 310.383 L 332.567 436.783 L 456 436.783 L 298.367 228.367 L 432.367 75.216 L 371.033 75.216 Z M 127.633 110 L 164.101 110 L 383.481 400.065 L 349.5 400.065 Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share How to import &#39;any&#39; Kubernetes package into your project? on linkedin"
            href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fsuraj.io%2fpost%2f2021%2f05%2fk8s-import%2f&amp;title=How%20to%20import%20%27any%27%20Kubernetes%20package%20into%20your%20project%3f&amp;summary=How%20to%20import%20%27any%27%20Kubernetes%20package%20into%20your%20project%3f&amp;source=https%3a%2f%2fsuraj.io%2fpost%2f2021%2f05%2fk8s-import%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-288.985,423.278l0,-225.717l-75.04,0l0,225.717l75.04,0Zm270.539,0l0,-129.439c0,-69.333 -37.018,-101.586 -86.381,-101.586c-39.804,0 -57.634,21.891 -67.617,37.266l0,-31.958l-75.021,0c0.995,21.181 0,225.717 0,225.717l75.02,0l0,-126.056c0,-6.748 0.486,-13.492 2.474,-18.315c5.414,-13.475 17.767,-27.434 38.494,-27.434c27.135,0 38.007,20.707 38.007,51.037l0,120.768l75.024,0Zm-307.552,-334.556c-25.674,0 -42.448,16.879 -42.448,39.002c0,21.658 16.264,39.002 41.455,39.002l0.484,0c26.165,0 42.452,-17.344 42.452,-39.002c-0.485,-22.092 -16.241,-38.954 -41.943,-39.002Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share How to import &#39;any&#39; Kubernetes package into your project? on reddit"
            href="https://reddit.com/submit?url=https%3a%2f%2fsuraj.io%2fpost%2f2021%2f05%2fk8s-import%2f&title=How%20to%20import%20%27any%27%20Kubernetes%20package%20into%20your%20project%3f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-3.446,265.638c0,-22.964 -18.616,-41.58 -41.58,-41.58c-11.211,0 -21.361,4.457 -28.841,11.666c-28.424,-20.508 -67.586,-33.757 -111.204,-35.278l18.941,-89.121l61.884,13.157c0.756,15.734 13.642,28.29 29.56,28.29c16.407,0 29.706,-13.299 29.706,-29.701c0,-16.403 -13.299,-29.702 -29.706,-29.702c-11.666,0 -21.657,6.792 -26.515,16.578l-69.105,-14.69c-1.922,-0.418 -3.939,-0.042 -5.585,1.036c-1.658,1.073 -2.811,2.761 -3.224,4.686l-21.152,99.438c-44.258,1.228 -84.046,14.494 -112.837,35.232c-7.468,-7.164 -17.589,-11.591 -28.757,-11.591c-22.965,0 -41.585,18.616 -41.585,41.58c0,16.896 10.095,31.41 24.568,37.918c-0.639,4.135 -0.99,8.328 -0.99,12.576c0,63.977 74.469,115.836 166.33,115.836c91.861,0 166.334,-51.859 166.334,-115.836c0,-4.218 -0.347,-8.387 -0.977,-12.493c14.564,-6.47 24.735,-21.034 24.735,-38.001Zm-119.474,108.193c-20.27,20.241 -59.115,21.816 -70.534,21.816c-11.428,0 -50.277,-1.575 -70.522,-21.82c-3.007,-3.008 -3.007,-7.882 0,-10.889c3.003,-2.999 7.882,-3.003 10.885,0c12.777,12.781 40.11,17.317 59.637,17.317c19.522,0 46.86,-4.536 59.657,-17.321c3.016,-2.999 7.886,-2.995 10.885,0.008c3.008,3.011 3.003,7.882 -0.008,10.889Zm-5.23,-48.781c-16.373,0 -29.701,-13.324 -29.701,-29.698c0,-16.381 13.328,-29.714 29.701,-29.714c16.378,0 29.706,13.333 29.706,29.714c0,16.374 -13.328,29.698 -29.706,29.698Zm-160.386,-29.702c0,-16.381 13.328,-29.71 29.714,-29.71c16.369,0 29.689,13.329 29.689,29.71c0,16.373 -13.32,29.693 -29.689,29.693c-16.386,0 -29.714,-13.32 -29.714,-29.693Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share How to import &#39;any&#39; Kubernetes package into your project? on facebook"
            href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fsuraj.io%2fpost%2f2021%2f05%2fk8s-import%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-106.468,0l0,-192.915l66.6,0l12.672,-82.621l-79.272,0l0,-53.617c0,-22.603 11.073,-44.636 46.58,-44.636l36.042,0l0,-70.34c0,0 -32.71,-5.582 -63.982,-5.582c-65.288,0 -107.96,39.569 -107.96,111.204l0,62.971l-72.573,0l0,82.621l72.573,0l0,192.915l-191.104,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share How to import &#39;any&#39; Kubernetes package into your project? on whatsapp"
            href="https://api.whatsapp.com/send?text=How%20to%20import%20%27any%27%20Kubernetes%20package%20into%20your%20project%3f%20-%20https%3a%2f%2fsuraj.io%2fpost%2f2021%2f05%2fk8s-import%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-58.673,127.703c-33.842,-33.881 -78.847,-52.548 -126.798,-52.568c-98.799,0 -179.21,80.405 -179.249,179.234c-0.013,31.593 8.241,62.428 23.927,89.612l-25.429,92.884l95.021,-24.925c26.181,14.28 55.659,21.807 85.658,21.816l0.074,0c98.789,0 179.206,-80.413 179.247,-179.243c0.018,-47.895 -18.61,-92.93 -52.451,-126.81Zm-126.797,275.782l-0.06,0c-26.734,-0.01 -52.954,-7.193 -75.828,-20.767l-5.441,-3.229l-56.386,14.792l15.05,-54.977l-3.542,-5.637c-14.913,-23.72 -22.791,-51.136 -22.779,-79.287c0.033,-82.142 66.867,-148.971 149.046,-148.971c39.793,0.014 77.199,15.531 105.329,43.692c28.128,28.16 43.609,65.592 43.594,105.4c-0.034,82.149 -66.866,148.983 -148.983,148.984Zm81.721,-111.581c-4.479,-2.242 -26.499,-13.075 -30.604,-14.571c-4.105,-1.495 -7.091,-2.241 -10.077,2.241c-2.986,4.483 -11.569,14.572 -14.182,17.562c-2.612,2.988 -5.225,3.364 -9.703,1.12c-4.479,-2.241 -18.91,-6.97 -36.017,-22.23c-13.314,-11.876 -22.304,-26.542 -24.916,-31.026c-2.612,-4.484 -0.279,-6.908 1.963,-9.14c2.016,-2.007 4.48,-5.232 6.719,-7.847c2.24,-2.615 2.986,-4.484 4.479,-7.472c1.493,-2.99 0.747,-5.604 -0.374,-7.846c-1.119,-2.241 -10.077,-24.288 -13.809,-33.256c-3.635,-8.733 -7.327,-7.55 -10.077,-7.688c-2.609,-0.13 -5.598,-0.158 -8.583,-0.158c-2.986,0 -7.839,1.121 -11.944,5.604c-4.105,4.484 -15.675,15.32 -15.675,37.364c0,22.046 16.048,43.342 18.287,46.332c2.24,2.99 31.582,48.227 76.511,67.627c10.685,4.615 19.028,7.371 25.533,9.434c10.728,3.41 20.492,2.929 28.209,1.775c8.605,-1.285 26.499,-10.833 30.231,-21.295c3.732,-10.464 3.732,-19.431 2.612,-21.298c-1.119,-1.869 -4.105,-2.99 -8.583,-5.232Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share How to import &#39;any&#39; Kubernetes package into your project? on telegram"
            href="https://telegram.me/share/url?text=How%20to%20import%20%27any%27%20Kubernetes%20package%20into%20your%20project%3f&amp;url=https%3a%2f%2fsuraj.io%2fpost%2f2021%2f05%2fk8s-import%2f">
            <svg version="1.1" xml:space="preserve" viewBox="2 2 28 28" height="30px" width="30px" fill="currentColor">
                <path
                    d="M26.49,29.86H5.5a3.37,3.37,0,0,1-2.47-1,3.35,3.35,0,0,1-1-2.47V5.48A3.36,3.36,0,0,1,3,3,3.37,3.37,0,0,1,5.5,2h21A3.38,3.38,0,0,1,29,3a3.36,3.36,0,0,1,1,2.46V26.37a3.35,3.35,0,0,1-1,2.47A3.38,3.38,0,0,1,26.49,29.86Zm-5.38-6.71a.79.79,0,0,0,.85-.66L24.73,9.24a.55.55,0,0,0-.18-.46.62.62,0,0,0-.41-.17q-.08,0-16.53,6.11a.59.59,0,0,0-.41.59.57.57,0,0,0,.43.52l4,1.24,1.61,4.83a.62.62,0,0,0,.63.43.56.56,0,0,0,.4-.17L16.54,20l4.09,3A.9.9,0,0,0,21.11,23.15ZM13.8,20.71l-1.21-4q8.72-5.55,8.78-5.55c.15,0,.23,0,.23.16a.18.18,0,0,1,0,.06s-2.51,2.3-7.52,6.8Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share How to import &#39;any&#39; Kubernetes package into your project? on ycombinator"
            href="https://news.ycombinator.com/submitlink?t=How%20to%20import%20%27any%27%20Kubernetes%20package%20into%20your%20project%3f&u=https%3a%2f%2fsuraj.io%2fpost%2f2021%2f05%2fk8s-import%2f">
            <svg version="1.1" xml:space="preserve" width="30px" height="30px" viewBox="0 0 512 512" fill="currentColor"
                xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape">
                <path
                    d="M449.446 0C483.971 0 512 28.03 512 62.554L512 449.446C512 483.97 483.97 512 449.446 512L62.554 512C28.03 512 0 483.97 0 449.446L0 62.554C0 28.03 28.029 0 62.554 0L449.446 0ZM183.8767 87.9921H121.8427L230.6673 292.4508V424.0079H281.3328V292.4508L390.1575 87.9921H328.1233L256 238.2489z" />
            </svg>
        </a>
    </li>
</ul>

  </footer><div id="disqus_thread"></div>
<script>
    window.disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "suraj-io" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2025 <a href="https://suraj.io/">Suraj Deshmukh</a></span> ¬∑ 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
