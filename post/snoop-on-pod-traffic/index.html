<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Watch Container Traffic Without Exec | Suraj Deshmukh</title>
<meta name="keywords" content="kubernetes, security, containers">
<meta name="description" content="How to watch the traffic of a container or a pod without execing into the pod/contaienr?">
<meta name="author" content="Suraj Deshmukh">
<link rel="canonical" href="https://suraj.io/post/snoop-on-pod-traffic/">
<meta name="google-site-verification" content="G-PYJ0C1KVD7">
<link crossorigin="anonymous" href="/assets/css/stylesheet.b609c58d5c11bb90b1a54e04005d74ad1ddf22165eb79f5533967e57df9c3b50.css" integrity="sha256-tgnFjVwRu5CxpU4EAF10rR3fIhZet59VM5Z&#43;V9&#43;cO1A=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://suraj.io/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://suraj.io/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://suraj.io/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://suraj.io/apple-touch-icon.png">
<link rel="mask-icon" href="https://suraj.io/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://suraj.io/post/snoop-on-pod-traffic/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>
<script>
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-97006720-1', 'auto');
	
	ga('send', 'pageview');
}
</script><meta property="og:title" content="Watch Container Traffic Without Exec" />
<meta property="og:description" content="How to watch the traffic of a container or a pod without execing into the pod/contaienr?" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://suraj.io/post/snoop-on-pod-traffic/" />
<meta property="og:image" content="https://suraj.io/images/papermod-cover.png" />
<meta property="article:section" content="post" />
<meta property="article:published_time" content="2020-06-06T20:30:07+05:30" />
<meta property="article:modified_time" content="2020-06-06T20:30:07+05:30" />

<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://suraj.io/images/papermod-cover.png" />
<meta name="twitter:title" content="Watch Container Traffic Without Exec"/>
<meta name="twitter:description" content="How to watch the traffic of a container or a pod without execing into the pod/contaienr?"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://suraj.io/post/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Watch Container Traffic Without Exec",
      "item": "https://suraj.io/post/snoop-on-pod-traffic/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Watch Container Traffic Without Exec",
  "name": "Watch Container Traffic Without Exec",
  "description": "How to watch the traffic of a container or a pod without execing into the pod/contaienr?",
  "keywords": [
    "kubernetes", "security", "containers"
  ],
  "articleBody": "Introduction For the reasons of security, many container deployments nowadays run their workloads in a scratch based image. This form of implementation helps reduce the attack surface since there is no shell to gain access to, especially if someone were to break out of the application.\nBut for the developers or operators of such applications, it is hard to debug. Since they lack essential tools or even bash for that matter, but the application’s debugging ability should not dictate its production deployment and compromise its security posture.\nThis blog shows one of the many debugging requirements of any connected application, i.e. network snooping or network debugging. I won’t emphasise the importance of network debugging in the world of microservices, where containers lead the deployment model.\nNow imagine a scenario where you have an application, statically built based on scratch image and running inside a container. How do you watch the traffic of such an app? You don’t have any terminal in that container. You are not allowed to make changes to the environment of the application because this is a production setup. This barebone container image deployment is the exact scenario that this post helps in debugging.\nContainer Scenario For the demo, I have a running application which is doing some networking.\n$ docker ps CONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES 241bf66c36c6 fedora \"bash\" 14 minutes ago Up 14 minutes upbeat_heisenberg The IP address of this application is 172.17.0.2 found using following command:\n$ docker inspect upbeat_heisenberg | grep IPAddress | tail -1 \"IPAddress\": \"172.17.0.2\", And on the server-side I have the following simple HTTP server running on the host machine:\n$ python3 -m http.server Serving HTTP on 0.0.0.0 port 8000 (http://0.0.0.0:8000/) ... 172.17.0.2 - - [06/Jun/2020 18:53:18] \"GET / HTTP/1.1\" 200 - [REDACTED] The IP address of the server is 172.17.0.1 found using the following command:\n$ ip address show docker0 | grep 'inet ' inet 172.17.0.1/16 brd 172.17.255.255 scope global docker0 Debugging Now I cannot exec into the container, but I want to see what traffic sent by the application inside the container. Let’s find out the PID of the process running inside the container:\n$ docker inspect --format '{{.State.Pid}}' 241bf66c36c6 1371226 Alright, now we know that the process running inside has PID 1371226. Now lets us try to enter into this process’s network namespace and use the good old tcpdump.\n$ sudo nsenter -t 1371226 -n tcpdump -A -s 0 '(((ip[2:2] - ((ip[0]\u00260xf)\u003c\u003c2)) - ((tcp[12]\u00260xf0)\u003e\u003e2)) != 0)' dropped privs to tcpdump tcpdump: verbose output suppressed, use -v or -vv for full protocol decode listening on eth0, link-type EN10MB (Ethernet), capture size 262144 bytes 19:21:26.685275 IP thinkpad.36852 \u003e _gateway.irdmi: Flags [P.], seq 2980991125:2980991212, ack 2001355994, win 502, options [nop,nop,TS val 3794513222 ecr 3920804277], length 87 E.....@.@..............@..P.wJD.....X...... .+.F....GET /file.txt HTTP/1.1 Host: 172.17.0.1:8000 User-Agent: curl/7.66.0 Accept: */* 19:21:26.686787 IP thinkpad.56338 \u003e XiaoQiang.domain: 8019+ PTR? 1.0.17.172.in-addr.arpa. (41) E..E..@.@..+...........5.1...S...........1.0.17.172.in-addr.arpa..... 19:21:26.686958 IP _gateway.irdmi \u003e thinkpad.36852: Flags [P.], seq 1:186, ack 87, win 509, options [nop,nop,TS val 3920804279 ecr 3794513222], length 185 E.....@.@.9/.........@..wJD...P.....Y...... .....+.FHTTP/1.0 200 OK Server: SimpleHTTP/0.6 Python/3.7.7 Date: Sat, 06 Jun 2020 13:51:26 GMT Content-type: text/plain Content-Length: 12 Last-Modified: Sat, 06 Jun 2020 13:22:34 GMT 19:21:26.687101 IP _gateway.irdmi \u003e thinkpad.36852: Flags [P.], seq 186:198, ack 87, win 509, options [nop,nop,TS val 3920804279 ecr 3794513224], length 12 E..@..@.@.9..........@..wJE...P.....XX..... .....+.HI am Server [REDACTED] There you go, the output shows that the target server 172.17.0.1:8000 is responding over HTTP protocol I am Server.\nWith Kubernetes The same can be achieved with Kubernetes as well. Follow these steps:\ndocker ps | grep ID= // take docker id by hand PID=`docker inspect --format '{{.State.Pid}}' $ID` sudo nsenter -t $PID -n tcpdump References and Credits Thanks to my colleague Mauricio Vásquez Bernal, from whom I learnt this trick. Tweet about these steps in brief details https://twitter.com/surajd_/status/1152218150932365312. The complex tcpdump command used to decode the HTTP traffic: https://sites.google.com/site/jimmyxu101/testing/use-tcpdump-to-monitor-http-traffic. ",
  "wordCount" : "642",
  "inLanguage": "en",
  "image": "https://suraj.io/images/papermod-cover.png","datePublished": "2020-06-06T20:30:07+05:30",
  "dateModified": "2020-06-06T20:30:07+05:30",
  "author":{
    "@type": "Person",
    "name": "Suraj Deshmukh"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://suraj.io/post/snoop-on-pod-traffic/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Suraj Deshmukh",
    "logo": {
      "@type": "ImageObject",
      "url": "https://suraj.io/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://suraj.io/" accesskey="h" title="Suraj Deshmukh (Alt + H)">Suraj Deshmukh</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://suraj.io/post" title="Blog">
                    <span>Blog</span>
                </a>
            </li>
            <li>
                <a href="https://suraj.io/about" title="About">
                    <span>About</span>
                </a>
            </li>
            <li>
                <a href="https://suraj.io/archives" title="Archives">
                    <span>Archives</span>
                </a>
            </li>
            <li>
                <a href="https://suraj.io/search" title="Search 🔍">
                    <span>Search 🔍</span>
                </a>
            </li>
            <li>
                <a href="https://suraj.io/tags" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
            <li>
                <a href="https://suraj.io/categories" title="Categories">
                    <span>Categories</span>
                </a>
            </li>
            <li>
                <a href="https://suraj.io/series" title="Series">
                    <span>Series</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://suraj.io/">Home</a>&nbsp;»&nbsp;<a href="https://suraj.io/post/">Posts</a></div>
    <h1 class="post-title entry-hint-parent">
      Watch Container Traffic Without Exec
    </h1>
    <div class="post-description">
      How to watch the traffic of a container or a pod without execing into the pod/contaienr?
    </div>
    <div class="post-meta"><span title='2020-06-06 20:30:07 +0530 +0530'>June 6, 2020</span>&nbsp;·&nbsp;4 min&nbsp;·&nbsp;Suraj Deshmukh&nbsp;|&nbsp;<a href="https://github.com/surajssd/blog_contents/blob/master/content/post/snoop-on-pod-traffic.md" rel="noopener noreferrer" target="_blank">Suggest Changes</a>

</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#introduction" aria-label="Introduction">Introduction</a></li>
                <li>
                    <a href="#container-scenario" aria-label="Container Scenario">Container Scenario</a></li>
                <li>
                    <a href="#debugging" aria-label="Debugging">Debugging</a></li>
                <li>
                    <a href="#with-kubernetes" aria-label="With Kubernetes">With Kubernetes</a></li>
                <li>
                    <a href="#references-and-credits" aria-label="References and Credits">References and Credits</a>
                </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><h2 id="introduction">Introduction<a hidden class="anchor" aria-hidden="true" href="#introduction">#</a></h2>
<p>For the reasons of security, many container deployments nowadays run their workloads in a scratch based image. This form of implementation helps reduce the attack surface since there is no shell to gain access to, especially if someone were to break out of the application.</p>
<p>But for the developers or operators of such applications, it is hard to debug. Since they lack essential tools or even <code>bash</code> for that matter, but the application&rsquo;s debugging ability should not dictate its production deployment and compromise its security posture.</p>
<p>This blog shows one of the many debugging requirements of any connected application, i.e. network snooping or network debugging. I won&rsquo;t emphasise the importance of network debugging in the world of microservices, where containers lead the deployment model.</p>
<p>Now imagine a scenario where you have an application, statically built based on scratch image and running inside a container. How do you watch the traffic of such an app? You don&rsquo;t have any terminal in that container. You are not allowed to make changes to the environment of the application because this is a production setup. This barebone container image deployment is the exact scenario that this post helps in debugging.</p>
<h2 id="container-scenario">Container Scenario<a hidden class="anchor" aria-hidden="true" href="#container-scenario">#</a></h2>
<p>For the demo, I have a running application which is doing some networking.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ docker ps
</span></span><span class="line"><span class="cl">CONTAINER ID    IMAGE     COMMAND   CREATED         STATUS          PORTS    NAMES
</span></span><span class="line"><span class="cl">241bf66c36c6    fedora    <span class="s2">&#34;bash&#34;</span>    <span class="m">14</span> minutes ago  Up <span class="m">14</span> minutes            upbeat_heisenberg
</span></span></code></pre></div><p>The IP address of this application is <code>172.17.0.2</code> found using following command:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ docker inspect upbeat_heisenberg <span class="p">|</span> grep IPAddress <span class="p">|</span> tail -1
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;IPAddress&#34;</span>: <span class="s2">&#34;172.17.0.2&#34;</span>,
</span></span></code></pre></div><p>And on the server-side I have the following simple HTTP server running on the host machine:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ python3 -m http.server
</span></span><span class="line"><span class="cl">Serving HTTP on 0.0.0.0 port <span class="m">8000</span> <span class="o">(</span>http://0.0.0.0:8000/<span class="o">)</span> ...
</span></span><span class="line"><span class="cl">172.17.0.2 - - <span class="o">[</span>06/Jun/2020 18:53:18<span class="o">]</span> <span class="s2">&#34;GET / HTTP/1.1&#34;</span> <span class="m">200</span> -
</span></span><span class="line"><span class="cl"><span class="o">[</span>REDACTED<span class="o">]</span>
</span></span></code></pre></div><p>The IP address of the server is <code>172.17.0.1</code> found using the following command:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ ip address show docker0 <span class="p">|</span> grep <span class="s1">&#39;inet &#39;</span>
</span></span><span class="line"><span class="cl">    inet 172.17.0.1/16 brd 172.17.255.255 scope global docker0
</span></span></code></pre></div><h2 id="debugging">Debugging<a hidden class="anchor" aria-hidden="true" href="#debugging">#</a></h2>
<p>Now I cannot exec into the container, but I want to see what traffic sent by the application inside the container. Let&rsquo;s find out the PID of the process running inside the container:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ docker inspect --format <span class="s1">&#39;{{.State.Pid}}&#39;</span> 241bf66c36c6
</span></span><span class="line"><span class="cl"><span class="m">1371226</span>
</span></span></code></pre></div><p>Alright, now we know that the process running inside has PID <code>1371226</code>. Now lets us try to enter into this process&rsquo;s network namespace and use the good old tcpdump.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ sudo nsenter -t <span class="m">1371226</span> -n tcpdump -A -s <span class="m">0</span> <span class="s1">&#39;(((ip[2:2] - ((ip[0]&amp;0xf)&lt;&lt;2)) - ((tcp[12]&amp;0xf0)&gt;&gt;2)) != 0)&#39;</span>
</span></span><span class="line"><span class="cl">dropped privs to tcpdump
</span></span><span class="line"><span class="cl">tcpdump: verbose output suppressed, use -v or -vv <span class="k">for</span> full protocol decode
</span></span><span class="line"><span class="cl">listening on eth0, link-type EN10MB <span class="o">(</span>Ethernet<span class="o">)</span>, capture size <span class="m">262144</span> bytes
</span></span><span class="line"><span class="cl">19:21:26.685275 IP thinkpad.36852 &gt; _gateway.irdmi: Flags <span class="o">[</span>P.<span class="o">]</span>, seq 2980991125:2980991212, ack 2001355994, win 502, options <span class="o">[</span>nop,nop,TS val <span class="m">3794513222</span> ecr 3920804277<span class="o">]</span>, length <span class="m">87</span>
</span></span><span class="line"><span class="cl">E.....@.@..............@..P.wJD.....X......
</span></span><span class="line"><span class="cl">.+.F....GET /file.txt HTTP/1.1
</span></span><span class="line"><span class="cl">Host: 172.17.0.1:8000
</span></span><span class="line"><span class="cl">User-Agent: curl/7.66.0
</span></span><span class="line"><span class="cl">Accept: */*
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">19:21:26.686787 IP thinkpad.56338 &gt; XiaoQiang.domain: 8019+ PTR? 1.0.17.172.in-addr.arpa. <span class="o">(</span>41<span class="o">)</span>
</span></span><span class="line"><span class="cl">E..E..@.@..+...........5.1...S...........1.0.17.172.in-addr.arpa.....
</span></span><span class="line"><span class="cl">19:21:26.686958 IP _gateway.irdmi &gt; thinkpad.36852: Flags <span class="o">[</span>P.<span class="o">]</span>, seq 1:186, ack 87, win 509, options <span class="o">[</span>nop,nop,TS val <span class="m">3920804279</span> ecr 3794513222<span class="o">]</span>, length <span class="m">185</span>
</span></span><span class="line"><span class="cl">E.....@.@.9/.........@..wJD...P.....Y......
</span></span><span class="line"><span class="cl">.....+.FHTTP/1.0 <span class="m">200</span> OK
</span></span><span class="line"><span class="cl">Server: SimpleHTTP/0.6 Python/3.7.7
</span></span><span class="line"><span class="cl">Date: Sat, <span class="m">06</span> Jun <span class="m">2020</span> 13:51:26 GMT
</span></span><span class="line"><span class="cl">Content-type: text/plain
</span></span><span class="line"><span class="cl">Content-Length: <span class="m">12</span>
</span></span><span class="line"><span class="cl">Last-Modified: Sat, <span class="m">06</span> Jun <span class="m">2020</span> 13:22:34 GMT
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">19:21:26.687101 IP _gateway.irdmi &gt; thinkpad.36852: Flags <span class="o">[</span>P.<span class="o">]</span>, seq 186:198, ack 87, win 509, options <span class="o">[</span>nop,nop,TS val <span class="m">3920804279</span> ecr 3794513224<span class="o">]</span>, length <span class="m">12</span>
</span></span><span class="line"><span class="cl">E..@..@.@.9..........@..wJE...P.....XX.....
</span></span><span class="line"><span class="cl">.....+.HI am Server
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>REDACTED<span class="o">]</span>
</span></span></code></pre></div><p>There you go, the output shows that the target server <code>172.17.0.1:8000</code> is responding over <code>HTTP</code> protocol <code>I am Server</code>.</p>
<h2 id="with-kubernetes">With Kubernetes<a hidden class="anchor" aria-hidden="true" href="#with-kubernetes">#</a></h2>
<p>The same can be achieved with Kubernetes as well. Follow these steps:</p>
<pre tabindex="0"><code>docker ps | grep &lt;pod-initial&gt;
ID= // take docker id by hand
PID=`docker inspect --format &#39;{{.State.Pid}}&#39; $ID`
sudo nsenter -t $PID -n tcpdump
</code></pre><h2 id="references-and-credits">References and Credits<a hidden class="anchor" aria-hidden="true" href="#references-and-credits">#</a></h2>
<ul>
<li>Thanks to my colleague <a href="https://twitter.com/maurovasquezb">Mauricio Vásquez Bernal</a>, from whom I learnt this trick.</li>
<li>Tweet about these steps in brief details <a href="https://twitter.com/surajd_/status/1152218150932365312">https://twitter.com/surajd_/status/1152218150932365312</a>.</li>
<li>The complex tcpdump command used to decode the HTTP traffic: <a href="https://sites.google.com/site/jimmyxu101/testing/use-tcpdump-to-monitor-http-traffic">https://sites.google.com/site/jimmyxu101/testing/use-tcpdump-to-monitor-http-traffic</a>.</li>
</ul>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://suraj.io/tags/kubernetes/">Kubernetes</a></li>
      <li><a href="https://suraj.io/tags/security/">Security</a></li>
      <li><a href="https://suraj.io/tags/containers/">Containers</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="https://suraj.io/post/book-review-einstein/">
    <span class="title">« Prev</span>
    <br>
    <span>Book Review of Einstein: His Life and Universe</span>
  </a>
  <a class="next" href="https://suraj.io/post/seccomp-in-kube-state-metrics/">
    <span class="title">Next »</span>
    <br>
    <span>Enabling Seccomp on your Prometheus Operator and related Pods</span>
  </a>
</nav>


<ul class="share-buttons">
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Watch Container Traffic Without Exec on x"
            href="https://x.com/intent/tweet/?text=Watch%20Container%20Traffic%20Without%20Exec&amp;url=https%3a%2f%2fsuraj.io%2fpost%2fsnoop-on-pod-traffic%2f&amp;hashtags=kubernetes%2csecurity%2ccontainers">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M512 62.554 L 512 449.446 C 512 483.97 483.97 512 449.446 512 L 62.554 512 C 28.03 512 0 483.97 0 449.446 L 0 62.554 C 0 28.03 28.029 0 62.554 0 L 449.446 0 C 483.971 0 512 28.03 512 62.554 Z M 269.951 190.75 L 182.567 75.216 L 56 75.216 L 207.216 272.95 L 63.9 436.783 L 125.266 436.783 L 235.9 310.383 L 332.567 436.783 L 456 436.783 L 298.367 228.367 L 432.367 75.216 L 371.033 75.216 Z M 127.633 110 L 164.101 110 L 383.481 400.065 L 349.5 400.065 Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Watch Container Traffic Without Exec on linkedin"
            href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fsuraj.io%2fpost%2fsnoop-on-pod-traffic%2f&amp;title=Watch%20Container%20Traffic%20Without%20Exec&amp;summary=Watch%20Container%20Traffic%20Without%20Exec&amp;source=https%3a%2f%2fsuraj.io%2fpost%2fsnoop-on-pod-traffic%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-288.985,423.278l0,-225.717l-75.04,0l0,225.717l75.04,0Zm270.539,0l0,-129.439c0,-69.333 -37.018,-101.586 -86.381,-101.586c-39.804,0 -57.634,21.891 -67.617,37.266l0,-31.958l-75.021,0c0.995,21.181 0,225.717 0,225.717l75.02,0l0,-126.056c0,-6.748 0.486,-13.492 2.474,-18.315c5.414,-13.475 17.767,-27.434 38.494,-27.434c27.135,0 38.007,20.707 38.007,51.037l0,120.768l75.024,0Zm-307.552,-334.556c-25.674,0 -42.448,16.879 -42.448,39.002c0,21.658 16.264,39.002 41.455,39.002l0.484,0c26.165,0 42.452,-17.344 42.452,-39.002c-0.485,-22.092 -16.241,-38.954 -41.943,-39.002Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Watch Container Traffic Without Exec on reddit"
            href="https://reddit.com/submit?url=https%3a%2f%2fsuraj.io%2fpost%2fsnoop-on-pod-traffic%2f&title=Watch%20Container%20Traffic%20Without%20Exec">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-3.446,265.638c0,-22.964 -18.616,-41.58 -41.58,-41.58c-11.211,0 -21.361,4.457 -28.841,11.666c-28.424,-20.508 -67.586,-33.757 -111.204,-35.278l18.941,-89.121l61.884,13.157c0.756,15.734 13.642,28.29 29.56,28.29c16.407,0 29.706,-13.299 29.706,-29.701c0,-16.403 -13.299,-29.702 -29.706,-29.702c-11.666,0 -21.657,6.792 -26.515,16.578l-69.105,-14.69c-1.922,-0.418 -3.939,-0.042 -5.585,1.036c-1.658,1.073 -2.811,2.761 -3.224,4.686l-21.152,99.438c-44.258,1.228 -84.046,14.494 -112.837,35.232c-7.468,-7.164 -17.589,-11.591 -28.757,-11.591c-22.965,0 -41.585,18.616 -41.585,41.58c0,16.896 10.095,31.41 24.568,37.918c-0.639,4.135 -0.99,8.328 -0.99,12.576c0,63.977 74.469,115.836 166.33,115.836c91.861,0 166.334,-51.859 166.334,-115.836c0,-4.218 -0.347,-8.387 -0.977,-12.493c14.564,-6.47 24.735,-21.034 24.735,-38.001Zm-119.474,108.193c-20.27,20.241 -59.115,21.816 -70.534,21.816c-11.428,0 -50.277,-1.575 -70.522,-21.82c-3.007,-3.008 -3.007,-7.882 0,-10.889c3.003,-2.999 7.882,-3.003 10.885,0c12.777,12.781 40.11,17.317 59.637,17.317c19.522,0 46.86,-4.536 59.657,-17.321c3.016,-2.999 7.886,-2.995 10.885,0.008c3.008,3.011 3.003,7.882 -0.008,10.889Zm-5.23,-48.781c-16.373,0 -29.701,-13.324 -29.701,-29.698c0,-16.381 13.328,-29.714 29.701,-29.714c16.378,0 29.706,13.333 29.706,29.714c0,16.374 -13.328,29.698 -29.706,29.698Zm-160.386,-29.702c0,-16.381 13.328,-29.71 29.714,-29.71c16.369,0 29.689,13.329 29.689,29.71c0,16.373 -13.32,29.693 -29.689,29.693c-16.386,0 -29.714,-13.32 -29.714,-29.693Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Watch Container Traffic Without Exec on facebook"
            href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fsuraj.io%2fpost%2fsnoop-on-pod-traffic%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-106.468,0l0,-192.915l66.6,0l12.672,-82.621l-79.272,0l0,-53.617c0,-22.603 11.073,-44.636 46.58,-44.636l36.042,0l0,-70.34c0,0 -32.71,-5.582 -63.982,-5.582c-65.288,0 -107.96,39.569 -107.96,111.204l0,62.971l-72.573,0l0,82.621l72.573,0l0,192.915l-191.104,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Watch Container Traffic Without Exec on whatsapp"
            href="https://api.whatsapp.com/send?text=Watch%20Container%20Traffic%20Without%20Exec%20-%20https%3a%2f%2fsuraj.io%2fpost%2fsnoop-on-pod-traffic%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-58.673,127.703c-33.842,-33.881 -78.847,-52.548 -126.798,-52.568c-98.799,0 -179.21,80.405 -179.249,179.234c-0.013,31.593 8.241,62.428 23.927,89.612l-25.429,92.884l95.021,-24.925c26.181,14.28 55.659,21.807 85.658,21.816l0.074,0c98.789,0 179.206,-80.413 179.247,-179.243c0.018,-47.895 -18.61,-92.93 -52.451,-126.81Zm-126.797,275.782l-0.06,0c-26.734,-0.01 -52.954,-7.193 -75.828,-20.767l-5.441,-3.229l-56.386,14.792l15.05,-54.977l-3.542,-5.637c-14.913,-23.72 -22.791,-51.136 -22.779,-79.287c0.033,-82.142 66.867,-148.971 149.046,-148.971c39.793,0.014 77.199,15.531 105.329,43.692c28.128,28.16 43.609,65.592 43.594,105.4c-0.034,82.149 -66.866,148.983 -148.983,148.984Zm81.721,-111.581c-4.479,-2.242 -26.499,-13.075 -30.604,-14.571c-4.105,-1.495 -7.091,-2.241 -10.077,2.241c-2.986,4.483 -11.569,14.572 -14.182,17.562c-2.612,2.988 -5.225,3.364 -9.703,1.12c-4.479,-2.241 -18.91,-6.97 -36.017,-22.23c-13.314,-11.876 -22.304,-26.542 -24.916,-31.026c-2.612,-4.484 -0.279,-6.908 1.963,-9.14c2.016,-2.007 4.48,-5.232 6.719,-7.847c2.24,-2.615 2.986,-4.484 4.479,-7.472c1.493,-2.99 0.747,-5.604 -0.374,-7.846c-1.119,-2.241 -10.077,-24.288 -13.809,-33.256c-3.635,-8.733 -7.327,-7.55 -10.077,-7.688c-2.609,-0.13 -5.598,-0.158 -8.583,-0.158c-2.986,0 -7.839,1.121 -11.944,5.604c-4.105,4.484 -15.675,15.32 -15.675,37.364c0,22.046 16.048,43.342 18.287,46.332c2.24,2.99 31.582,48.227 76.511,67.627c10.685,4.615 19.028,7.371 25.533,9.434c10.728,3.41 20.492,2.929 28.209,1.775c8.605,-1.285 26.499,-10.833 30.231,-21.295c3.732,-10.464 3.732,-19.431 2.612,-21.298c-1.119,-1.869 -4.105,-2.99 -8.583,-5.232Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Watch Container Traffic Without Exec on telegram"
            href="https://telegram.me/share/url?text=Watch%20Container%20Traffic%20Without%20Exec&amp;url=https%3a%2f%2fsuraj.io%2fpost%2fsnoop-on-pod-traffic%2f">
            <svg version="1.1" xml:space="preserve" viewBox="2 2 28 28" height="30px" width="30px" fill="currentColor">
                <path
                    d="M26.49,29.86H5.5a3.37,3.37,0,0,1-2.47-1,3.35,3.35,0,0,1-1-2.47V5.48A3.36,3.36,0,0,1,3,3,3.37,3.37,0,0,1,5.5,2h21A3.38,3.38,0,0,1,29,3a3.36,3.36,0,0,1,1,2.46V26.37a3.35,3.35,0,0,1-1,2.47A3.38,3.38,0,0,1,26.49,29.86Zm-5.38-6.71a.79.79,0,0,0,.85-.66L24.73,9.24a.55.55,0,0,0-.18-.46.62.62,0,0,0-.41-.17q-.08,0-16.53,6.11a.59.59,0,0,0-.41.59.57.57,0,0,0,.43.52l4,1.24,1.61,4.83a.62.62,0,0,0,.63.43.56.56,0,0,0,.4-.17L16.54,20l4.09,3A.9.9,0,0,0,21.11,23.15ZM13.8,20.71l-1.21-4q8.72-5.55,8.78-5.55c.15,0,.23,0,.23.16a.18.18,0,0,1,0,.06s-2.51,2.3-7.52,6.8Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Watch Container Traffic Without Exec on ycombinator"
            href="https://news.ycombinator.com/submitlink?t=Watch%20Container%20Traffic%20Without%20Exec&u=https%3a%2f%2fsuraj.io%2fpost%2fsnoop-on-pod-traffic%2f">
            <svg version="1.1" xml:space="preserve" width="30px" height="30px" viewBox="0 0 512 512" fill="currentColor"
                xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape">
                <path
                    d="M449.446 0C483.971 0 512 28.03 512 62.554L512 449.446C512 483.97 483.97 512 449.446 512L62.554 512C28.03 512 0 483.97 0 449.446L0 62.554C0 28.03 28.029 0 62.554 0L449.446 0ZM183.8767 87.9921H121.8427L230.6673 292.4508V424.0079H281.3328V292.4508L390.1575 87.9921H328.1233L256 238.2489z" />
            </svg>
        </a>
    </li>
</ul>

  </footer><div id="disqus_thread"></div>
<script>
    window.disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "suraj-io" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2024 <a href="https://suraj.io/">Suraj Deshmukh</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
